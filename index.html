async function executeAddGroup(){
    const id = document.getElementById('ng-select').value;
    const gName = document.getElementById('ng-name').value.trim();
    const gMonths = document.getElementById('ng-months').value;

    if(!gName) return alert("Group Name is required!");

    // Ensure months is sent as a pure number
    const data = { 
        name: gName, 
        total_months: parseInt(gMonths) || 21 
    };

    const isNew = (id === 'new');
    const url = isNew ? `${SB_URL}/rest/v1/groups` : `${SB_URL}/rest/v1/groups?id=eq.${id}`;
    
    try {
        const res = await fetch(url, { 
            method: isNew ? 'POST' : 'PATCH', 
            headers: {
                'Content-Type': 'application/json',
                'apikey': SB_KEY,
                'Authorization': 'Bearer ' + SB_KEY,
                'Prefer': 'return=minimal'
            }, 
            body: JSON.stringify(data) 
        });
        
        if(res.ok) { 
            alert("Group Saved Successfully!"); 
            closeModal('addGroupModal'); 
            location.reload(); // Hard refresh to show the new group
        } else {
            const err = await res.json();
            alert("Database Error: " + err.message);
        }
    } catch(e) {
        alert("Connection Error: Check if Supabase URL is correct.");
    }
}
